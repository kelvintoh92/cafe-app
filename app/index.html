<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Studio Café by DBMK × GIF</title>
  <style>
    :root {
      --bg: #faf9f6;
      --card: #fff;
      --text: #333;
      --accent: #c49a6c;
      --radius: 8px;
      --gap: 16px;
    }
    body {
      margin: 0;
      background: var(--bg);
      font-family: 'Helvetica Neue', sans-serif;
      color: var(--text);
    }
    header {
      padding: var(--gap);
      text-align: center;
      background: var(--card);
      box-shadow: 0 1px 4px rgba(0,0,0,.1);
    }
    h1 {
      margin: 0;
      font-size: 1.5rem;
      font-family: 'Playfair Display', serif;
      color: var(--accent);
    }
    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: var(--gap);
      margin: var(--gap);
    }
    .form-row input {
      flex: 1 1 100px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: var(--radius);
      font-size: 1rem;
    }
    #menu, #order-summary {
      max-width: 600px;
      margin: 0 auto var(--gap);
      padding: var(--gap);
      background: var(--card);
      border-radius: var(--radius);
    }
    .menu-item {
      border: 1px solid #eee;
      border-radius: var(--radius);
      padding: var(--gap);
      margin-bottom: var(--gap);
      transition: box-shadow .2s;
    }
    .menu-item:hover {
      box-shadow: 0 2px 6px rgba(0,0,0,.1);
    }
    .menu-item h3 {
      margin: 0 0 8px;
      font-family: 'Playfair Display', serif;
    }
    .menu-item p {
      margin: 4px 0;
      font-size: .9rem;
    }
    .menu-item .controls {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 8px;
    }
    .menu-item .controls input,
    .menu-item .controls select {
      padding: 4px;
      font-size: .9rem;
      border: 1px solid #ccc;
      border-radius: var(--radius);
    }
    .menu-item .controls button {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 6px 12px;
      border-radius: var(--radius);
      cursor: pointer;
      font-size: .9rem;
    }
    #order-summary ul {
      list-style: none;
      padding: 0;
      margin: 0 0 var(--gap);
    }
    #order-summary li {
      margin-bottom: 4px;
      font-size: .95rem;
    }
    #order-summary .total {
      font-weight: bold;
      margin-top: var(--gap);
    }
    #order-summary button {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 8px 16px;
      margin-right: 8px;
      border-radius: var(--radius);
      cursor: pointer;
      font-size: 1rem;
    }
  </style>
</head>
<body>

  <header>
    <h1>Studio Café by DBMK × GIF</h1>
  </header>

  <div class="form-row">
    <input id="table-number" type="number" placeholder="Table # (1–10)" min="1" max="10"/>
    <input id="customer-name" type="text" placeholder="Your Name"/>
    <input id="customer-email" type="email" placeholder="Your Email"/>
  </div>

  <section id="menu"></section>

  <section id="order-summary">
    <h2>Order Summary</h2>
    <ul id="order-list"></ul>
    <div class="total">Total: RM <span id="order-total">0.00</span></div>
    <button id="submit-order">Submit Order</button>
    <button id="clear-order">Clear Order</button>
  </section>

  <script>
    // 1. Your menu data, including a single "Gelato" item with variations/flavors
    const menu = [
      // Drinks, Sandwiches, Bites, Desserts (unchanged from your original)
      { name: "Black (Hot)", price: 10, category: "Drinks", description: "Bold and robust black coffee, served hot." },
      { name: "Black (Iced)", price: 11, category: "Drinks", description: "Refreshing black coffee, chilled." },
      { name: "White (Hot)", price: 12, category: "Drinks", description: "Smooth coffee with milk, served hot." },
      { name: "White (Iced)", price: 13, category: "Drinks", description: "Chilled coffee with milk." },
      { name: "Matcha Latte (Hot)", price: 13, category: "Drinks", description: "Finely ground matcha whisked with warm milk." },
      { name: "Matcha Latte (Iced)", price: 14, category: "Drinks", description: "Iced matcha latte, vibrant and refreshing." },

      { name: "PB & J Sandwich", price: 9, category: "Open Sandwiches", description: "Peanut butter & raspberry jam on a toasted bun." },
      { name: "Crispy Egg Mayo", price: 10, category: "Open Sandwiches", description: "Creamy egg mayo on a toasted muffin." },
      { name: "Creamy Mushroom", price: 12, category: "Open Sandwiches", description: "Sautéed mushrooms in cream sauce on muffin." },

      { name: "Curly Fries + Cheese", price: 16, category: "Small Bites", description: "Seasoned fries with cheese sauce." },
      { name: "Curly Fries + Mentaiko", price: 18, category: "Small Bites", description: "Seasoned fries with mentaiko mayo." },

      { name: "Affogato (PB&J)", price: 18, category: "Desserts", description: "PB&J gelato drowned in hot espresso." },
      { name: "Affogato (Dark Choc)", price: 18, category: "Desserts", description: "Dark choc gelato drowned in hot espresso." },
      { name: "Mont Ember", price: 23, category: "Desserts", description: "Classic affogato with French canelé." },
      { name: "French Toast + Gelato", price: 20, category: "Desserts", description: "Rich french toast with dark choc gelato." },
      { name: "Canelé", price: 8, category: "Desserts", description: "Caramelized crust, custard center pastry." },

      // Single Gelato entry with 1–3 scoop variations
      {
        name: "Gelato",
        category: "Gelato",
        description: "Choose your scoop count and flavor(s).",
        variations: [
          { label: "1 Scoop", price: 10, maxFlavors: 1 },
          { label: "2 Scoops", price: 18, maxFlavors: 2 },
          { label: "3 Scoops", price: 25, maxFlavors: 3 }
        ],
        flavors: [
          "Roasted Soybean", "Black Sesame",
          "Lime Basil", "PB&J",
          "Dark Chocolate Sea Salt",
          "Hazelnut Orange"
        ]
      }
    ];

    let order = [];

    // 2. Build the menu UI
    function populateMenu() {
      const container = document.getElementById("menu");
      container.innerHTML = "";
      menu.forEach(item => {
        const card = document.createElement("div");
        card.className = "menu-item";
        card.innerHTML = `
          <h3>${item.name}</h3>
          <p>${item.description}</p>
        `;

        // If item has variations (only Gelato here), show size selector
        let varSelect = null;
        if (item.variations) {
          varSelect = document.createElement("select");
          varSelect.className = "variation-select";
          item.variations.forEach(v => {
            const opt = document.createElement("option");
            opt.value = JSON.stringify(v);
            opt.textContent = `${v.label} — RM ${v.price.toFixed(2)}`;
            varSelect.append(opt);
          });
          card.append(varSelect);
        }

        // Flavor selects if more than 1 flavor allowed
        const flavourContainer = document.createElement("div");
        flavourContainer.className = "flavor-container";
        card.append(flavourContainer);

        if (varSelect) {
          varSelect.addEventListener("change", () => {
            // clear old flavor inputs
            flavourContainer.innerHTML = "";
            const v = JSON.parse(varSelect.value);
            for (let i = 0; i < v.maxFlavors; i++) {
              const fsel = document.createElement("select");
              item.flavors.forEach(fl => {
                const fo = document.createElement("option");
                fo.value = fl;
                fo.textContent = fl;
                fsel.append(fo);
              });
              flavourContainer.append(fsel);
            }
          });
          // trigger initial flavor for 1 Scoop
          varSelect.dispatchEvent(new Event("change"));
        }

        // Quantity input & Add button
        const controls = document.createElement("div");
        controls.className = "controls";
        controls.innerHTML = `
          <input type="number" class="qty-input" value="1" min="1" style="width:50px;"/>
          <button>Add</button>
        `;
        controls.querySelector("button").addEventListener("click", () => {
          addToOrder(item, varSelect, flavourContainer);
        });
        card.append(controls);

        container.append(card);
      });
    }

    // 3. Add to order
    function addToOrder(item, varSelect, flavourContainer) {
      let selectedVar = { label: "", price: item.price, maxFlavors: 1 };
      if (varSelect) {
        selectedVar = JSON.parse(varSelect.value);
      }
      const qty = parseInt(flavourContainer.parentNode.querySelector(".qty-input").value, 10) || 1;
      // gather chosen flavors
      const chosenFlavors = [...flavourContainer.querySelectorAll("select")].map(s => s.value);

      order.push({
        name: item.name,
        variation: selectedVar.label,
        price: selectedVar.price,
        flavors: chosenFlavors,
        qty
      });
      renderOrderSummary();
    }

    // 4. Render summary
    function renderOrderSummary() {
      const list = document.getElementById("order-list");
      const totalEl = document.getElementById("order-total");
      list.innerHTML = "";
      let total = 0;
      order.forEach((o,i) => {
        total += o.price * o.qty;
        const li = document.createElement("li");
        li.textContent = `${o.name} (${o.variation}${o.flavors.length ? ": " + o.flavors.join(", ") : ""}) × ${o.qty} — RM ${(o.price*o.qty).toFixed(2)}`;
        list.append(li);
      });
      totalEl.textContent = total.toFixed(2);
    }

    // 5. Hook up Clear & Submit
    document.getElementById("clear-order").onclick = () => {
      order = [];
      renderOrderSummary();
    };
    document.getElementById("submit-order").onclick = () => {
      alert("Order submitted!\nCheck console for data.");
      console.log({
        table: document.getElementById("table-number").value,
        name: document.getElementById("customer-name").value,
        email: document.getElementById("customer-email").value,
        order
      });
      // TODO: send `order` to Firestore or EmailJS here
    };

    // initialize
    populateMenu();
    renderOrderSummary();
  </script>

</body>
</html>

</script>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
  (function(){
    emailjs.init("apCgXY03qnGQFDXBb"); // Replace with your EmailJS public key
  })();
  </script></body></html>
